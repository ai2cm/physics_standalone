########################################################################
# Physical constants
########################################################################
import numpy as np

# sfc_drv

cp = 1.0046e+3
hvap = 2.5e+6
grav = 9.80665
rd = 2.8705e+2
eps = rd/4.6150e+2
epsm1 = rd/4.6150e+2 - 1.
rvrdm1 = 4.6150e+2/rd - 1.

nsold = 4
gs1 = 9.8
gs2 = 9.81
tfreez = 2.7315e+2
lsubc = 2.501e+6
lsubf = 3.335e5
lsubs = 2.83e+6
elcp = 2.4888e+3
rd1 = 287.04
cp = 1.0046e+3
cp1 = 1004.5
cp2 = 1004.0
cph2o1 = 4.218e+3
cph2o2 = 4.2e6
cpice = 2.1060e+3
cpice1 = 2.106e6
sigma1 = 5.67e-8

# redprm

zbot = -8.0
salp = 4.0
cfactr = 0.5
cmcmax = 0.5e-3
sbeta = -2.0
rsmax = 5000.0
topt = 298.0
refdk = 2.0e-6
frzk = 0.15
fxexp = 2.0
refkdt = 3.0
czil = 0.075
csoil = 2.00e+6

smhigh = 6.0
smlow = 0.5

# assume isot == 1
bb = np.array([
    4.05,  4.26, 4.74, 5.33, 5.33,  5.25,
    6.77,  8.72,  8.17, 10.73, 10.39,  11.55,
    5.25,  4.26,  4.05, 4.26,  11.55,  4.05,
    4.05,  0.00,  0.00, 0.00,  0.00,  0.00,
    0.00,  0.00,  0.00, 0.00,  0.00,  0.00
])
drysmc = np.array([
    0.010, 0.025, 0.010, 0.010, 0.010, 0.010,
    0.010, 0.010, 0.010, 0.010, 0.010, 0.010,
    0.010, 0.010, 0.010, 0.010, 0.010, 0.010,
    0.010, 0.000, 0.000, 0.000, 0.000, 0.000,
    0.000, 0.000, 0.000, 0.000, 0.000, 0.000
])
maxsmc = np.array([
    0.395, 0.421, 0.434, 0.476, 0.476, 0.439,
    0.404, 0.464, 0.465, 0.406, 0.468, 0.457,
    0.464, 0.421, 0.200, 0.421, 0.457, 0.200,
    0.395, 0.000, 0.000, 0.000, 0.000, 0.000,
    0.000, 0.000, 0.000, 0.000, 0.000, 0.00
])
satpsi = np.array([
    0.035, 0.0363, 0.1413, 0.7586, 0.7586, 0.3548,
    0.1349, 0.6166, 0.2630, 0.0977, 0.3236, 0.4677,
    0.3548, 0.0363, 0.0350, 0.0363, 0.4677, 0.0350,
    0.0350, 0.00, 0.00, 0.00, 0.00, 0.00,
    0.00, 0.00, 0.00, 0.00, 0.00, 0.00
])
satdk = np.array([
    1.76e-4, 1.4078e-5, 5.2304e-6, 2.8089e-6, 2.8089e-6,
    3.377e-6, 4.4518e-6, 2.0348e-6, 2.4464e-6, 7.2199e-6,
    1.3444e-6, 9.7394e-7, 3.377e-6, 1.4078e-5, 1.4087e-05,
    1.4078e-5, 9.7394e-7, 1.4078e-5, 1.760e-4, 0.00,
    0.00, 0.00, 0.00, 0.00, 0.00,
    0.00, 0.00, 0.00, 0.00, 0.00
])
qtz = np.array([
    0.92, 0.82, 0.25, 0.15, 0.10, 0.20,
    0.60, 0.10, 0.35, 0.52, 0.10, 0.25,
    0.05, 0.25, 0.07, 0.25, 0.60, 0.52,
    0.92, 0.00, 0.00, 0.00, 0.00, 0.00,
    0.00, 0.00, 0.00, 0.00, 0.00, 0.00
])
defined_soil = 19

satdw = np.zeros(satdk.size)
f11 = np.zeros(satdk.size)
refsmc = np.zeros(satdk.size)
wltsmc = np.zeros(satdk.size)

i = (satdk != 0.) & (bb > 0.)
satdw[i] = bb[i] * satdk[i] * satpsi[i] / maxsmc[i]
f11[i] = np.log10(satpsi[i]) + bb[i]*np.log10(maxsmc[i]) + 2.0
refsmc1 = maxsmc[i]*np.power(5.79E-9/satdk[i], 1.0/(2.0*bb[i] + 3.0))
refsmc[i] = refsmc1 + (maxsmc[i]-refsmc1)/smhigh
wltsmc1 = maxsmc[i] * np.power(200./satpsi[i], -1./bb[i])
wltsmc[i] = wltsmc1 - smlow*wltsmc1

# assume ivet == 1
slope_data = np.zeros(30)
slope_data[:20] = 1.0
snupx = np.array([
    0.080, 0.080, 0.080, 0.080, 0.080, 0.020,
    0.020, 0.060, 0.040, 0.020, 0.010, 0.020,
    0.020, 0.020, 0.013, 0.013, 0.010, 0.020,
    0.020, 0.020, 0.000, 0.000, 0.000, 0.000,
    0.000, 0.000, 0.000, 0.000, 0.000, 0.000
])
rsmtbl = np.array([
    300.0, 300.0, 70.0, 175.0, 175.0, 70.0,
    70.0, 70.0, 70.0, 20.0, 40.0, 20.0,
    400.0, 35.0, 200.0, 70.0, 100.0, 70.0,
    150.0, 200.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0
])
rgltbl = np.array([
    30.0,  30.0,  30.0,  30.0,  30.0,  100.0,
    100.0, 65.0, 65.0, 100.0, 100.0, 100.0,
    100.0, 100.0, 100.0, 100.0, 30.0, 100.0,
    100.0, 100.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0
])
hstbl = np.array([
    47.35, 41.69, 47.35, 54.53, 51.93, 42.00,
    42.00, 42.00, 42.00, 36.35, 60.00, 36.25,
    42.00, 36.25, 42.00, 42.00, 51.75, 42.00,
    42.00, 42.00, 0.00, 0.00, 0.00, 0.00,
    0.00, 0.00, 0.00,  0.00,  0.00,  0.00
])
lai_data = np.array([
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0
])
# number of defined veg used
defined_veg = 20
nroot_data = np.array([4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 1, 3, 2,
                       3, 1, 3, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
bare = 16
defined_slope = 9
